const NO_SHADOW={color:"transparent",blur:0},TWOPI=2*Math.PI;class RadialMenu{constructor({fontFamily:t,fontSize:i,innerCircle:s,outerCircle:e,rotation:o,shadowBlur:h,shadowColor:n,shadowOffsetX:r,shadowOffsetY:a,backgroundColor:l,borderColor:c,textColor:d,textBorderColor:u,textShadowColor:f,textShadowBlur:w,textShadowOffsetX:b,textShadowOffsetY:C,buttonGap:x,buttons:S,posX:v,posY:y,isFixed:g,zIndex:p}={}){if(this.scale=window.devicePixelRatio,this.fontFamily=t||"FontAwesome",this.fontSize=i||14,isNaN(this.fontSize))throw"Font size must be a number";if(this.innerCircle=isNaN(s)?50:s,this.outerCircle=isNaN(e)?100:e,this.innerCircle>this.outerCircle)throw"Inner circle can't be larger than outer circle";if(this.innerCircle<0)throw"Inner circle can't be negative";this.rotation=Math.abs(o%TWOPI)||0,this.shadowStyle={color:n||"rgba(0,0,0,0.5)",blur:isNaN(h)?10:h,offsetX:isNaN(r)?3:r,offsetY:isNaN(a)?3:a},this.backgroundColor=l||"#EEE",this.borderColor=c||"#FFF",this.buttonGap=x||0,this.textColor=d||"#000",this.textBorderColor=u||"transparent",this.textShadowColor=f||"transparent",this.textShadowBlur=isNaN(w)?10:w,this.textShadowOffsetX=isNaN(b)?3:b,this.textShadowOffsetY=isNaN(C)?3:C,this.buttons=S||[{text:"",action:()=>{alert(1)}},{text:"",action:()=>{alert(2)}},{text:"",action:()=>{alert(3)}}],this.checkButtons(),this.posX=v||0,this.posY=y||0,this.isFixed=g||!1,this.zIndex=p||9999,this.canvas=document.createElement("canvas"),document.body.appendChild(this.canvas),this.init(),this.draw(),this.addEvent()}init(){this.step=TWOPI/this.buttons.length,this.w=2*this.outerCircle+2*this.shadowStyle.blur+2*this.shadowStyle.offsetX,this.h=2*this.outerCircle+2*this.shadowStyle.blur+2*this.shadowStyle.offsetY,this.canvas.style.display="none",this.canvas.style.position="fixed",this.canvas.style.width=this.w+"px",this.canvas.style.height=this.h+"px",this.canvas.width=this.w*this.scale,this.canvas.height=this.h*this.scale,this.c=this.canvas.getContext("2d"),this.c.scale(this.scale,this.scale),this.c.font=this.fontSize+"px "+this.fontFamily,this.canvas.style.zIndex=this.zIndex,this.w2=this.w>>1,this.h2=this.h>>1,this.backgroundColor instanceof Object&&(this.backgroundColor=this.createGradient(this.backgroundColor)),this.borderColor instanceof Object&&(this.borderColor=this.createGradient(this.borderColor)),this.shadowStyle.color instanceof Object&&(this.shadowStyle.color=this.createGradient(this.shadowStyle.color)),this.textColor instanceof Object&&(this.textColor=this.createGradient(this.textColor)),this.textBorderColor instanceof Object&&(this.textBorderColor=this.createGradient(this.textBorderColor)),this.textShadowColor instanceof Object&&(this.textShadowColor=this.createGradient(this.textShadowColor));const t=this.buttonGap,i=t*Math.PI*this.innerCircle/this.outerCircle;for(let s=0;s<this.buttons.length;s++){this.buttons[s].ini=(s*this.step+this.rotation+t)%TWOPI,this.buttons[s].fin=(this.buttons[s].ini+this.step-2*t)%TWOPI,this.buttons[s].ini_inner=(s*this.step+this.rotation+i)%TWOPI,this.buttons[s].fin_inner=(this.buttons[s].ini_inner+this.step-2*i)%TWOPI,this.buttons[s].ini>this.buttons[s].fin&&(this.rest=s);const e=this.buttons[s].ini+this.step/2-t;this.buttons[s].centerX=Math.cos(e)*(this.innerCircle+(this.outerCircle-this.innerCircle)/2)-this.fontSize/2,this.buttons[s].centerY=Math.sin(e)*(this.innerCircle+(this.outerCircle-this.innerCircle)/2)+this.fontSize/4}}draw(){const t=this.c;t.imageSmoothingEnabled=!0,t.imageSmoothingQuality="high",t.clearRect(0,0,this.w,this.h),this.buttonGap||(setContextShadowStyle(t,this.shadowStyle),t.fillStyle=this.shadowStyle.color,t.beginPath(),t.arc(this.w2,this.h2,this.outerCircle,0,TWOPI),t.arc(this.w2,this.h2,this.innerCircle,TWOPI,0,!0),t.fill());for(let i=0;i<this.buttons.length;i++){const s=this.buttons[i];this.buttonGap?setContextShadowStyle(t,this.shadowStyle):setContextShadowStyle(t,NO_SHADOW),t.fillStyle="backgroundColor"in s?s.backgroundColor:this.backgroundColor,t.strokeStyle="borderColor"in s?s.borderColor:this.borderColor,t.beginPath(),t.arc(this.w2,this.h2,this.outerCircle,s.ini,s.fin),t.arc(this.w2,this.h2,this.innerCircle,s.fin_inner,s.ini_inner,!0),t.closePath(),t.fill(),this.buttonGap&&setContextShadowStyle(t,NO_SHADOW),t.stroke(),setContextShadowStyle(t,{color:"textShadowColor"in s?s.textShadowColor:this.textShadowColor,blur:"textShadowBlur"in s?s.textShadowBlur:this.textShadowBlur,offsetX:"textShadowOffsetX"in s?s.textShadowOffsetX:this.textShadowOffsetX,offsetY:"textShadowOffsetY"in s?s.textShadowOffsetY:this.textShadowOffsetY}),t.fillStyle="textColor"in s?s.textColor:this.textColor,t.strokeStyle="textBorderColor"in s?s.textBorderColor:this.textBorderColor,t.save(),t.translate(this.w2,this.h2),t.fillText(s.text,s.centerX,s.centerY),t.strokeText(s.text,s.centerX,s.centerY),t.restore()}}addEvent(){if(this.canvas.addEventListener("click",t=>{let i=this.getButton(t.clientX,t.clientY);i&&i.action()}),this.isFixed)return this.setPos(this.posX,this.posY),void this.show();document.addEventListener("click",t=>{this.hide()}),document.oncontextmenu=(t=>{t.preventDefault(),this.setPos(t.clientX-this.w2,t.clientY-this.h2),this.show()}),!!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&(document.addEventListener("touchstart",t=>{this.timer=setTimeout(()=>{this.setPos(t.touches[0].clientX-this.w2,t.touches[0].clientY-this.h2),this.show()},500)}),document.addEventListener("touchend",()=>{this.timer&&clearTimeout(this.timer)}))}distance(t,i,s,e){return Math.sqrt((s-t)**2+(e-i)**2)}hide(){this.canvas.style.display="none"}show(){this.draw(),this.canvas.style.display="block"}setPos(t,i){if(isNaN(t)||isNaN(i))throw"X and Y must be numbers";this.canvas.style.left=t+"px",this.canvas.style.top=i+"px"}createGradient(t){if(!("gradient"in t))throw"Invalid gradient object";let i;switch(t.gradient){case"radial":i=this.c.createRadialGradient(this.w2,this.h2,this.innerCircle,this.w2,this.h2,this.outerCircle);break;case"linear1":i=this.c.createLinearGradient(0,0,0,this.canvas.height);break;case"linear2":i=this.c.createLinearGradient(0,0,this.canvas.width,0);break;case"linear3":i=this.c.createLinearGradient(0,0,this.canvas.width,this.canvas.height);break;case"linear4":i=this.c.createLinearGradient(0,this.canvas.height,this.canvas.width,0);break;default:throw"Invalid gradient value"}for(const s in t.colors){if(isNaN(s)||s<0||s>1)throw"Invalid color position";i.addColorStop(s,t.colors[s])}return i}checkButtons(){if(!(this.buttons instanceof Array))throw"Buttons must be an Array of button objects";for(let t=0;t<this.buttons.length;t++){const i=this.buttons[t];if(!("text"in i&&"action"in i))throw"Button must have a text and an action value"}}addButtons(t){this.buttons=t,this.checkButtons(),this.init()}getButton(t,i){const s=this.canvas.getBoundingClientRect(),e=this.w/s.width,o=this.h/s.height,h=(s.left+this.w2)*e,n=(s.top+this.h2)*o,r=this.distance(t,i,h,n);let a;if(r>this.innerCircle&&r<this.outerCircle){let s=Math.atan2(i-n,t-h);s=s>0?s:TWOPI+s;for(let t=0;t<this.buttons.length;t++)if(s>=this.buttons[t].ini&&s<=this.buttons[t].fin){a=this.buttons[t];break}!a&&this.rest&&(s<this.buttons[this.rest].ini&&(s+=TWOPI),s>=this.buttons[this.rest].ini&&s<=this.buttons[this.rest].fin+TWOPI&&(a=this.buttons[this.rest]))}return a}}function setContextShadowStyle(t,i){t.shadowColor=i.color,t.shadowBlur=i.blur,t.shadowOffsetX=i.offsetX,t.shadowOffsetY=i.offsetY}